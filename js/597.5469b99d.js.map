{"version":3,"file":"js/597.5469b99d.js","mappings":"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","sources":["webpack://toutiao/./src/pages/home/pages/homepage/index.vue","webpack://toutiao/./src/api/channel.js","webpack://toutiao/src/pages/home/pages/homepage/index.vue","webpack://toutiao/./src/pages/home/pages/homepage/index.vue?5886","webpack://toutiao/./src/pages/home/pages/homepage/index.vue?a00d"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"homepage\"},[_c('header',[_c('nav',[_c('van-tabs',{on:{\"change\":_vm.onTabChange},model:{value:(_vm.activeChannel),callback:function ($$v) {_vm.activeChannel=$$v},expression:\"activeChannel\"}},_vm._l((_vm.channels),function(item){return _c('van-tab',{key:item.id,attrs:{\"title\":item.name}})}),1)],1),_c('van-icon',{staticClass:\"icon\",attrs:{\"name\":\"search\",\"color\":\"#999\",\"size\":\"20\"},on:{\"click\":_vm.onSearch}}),_c('van-icon',{staticClass:\"icon\",attrs:{\"name\":\"more-o\",\"color\":\"#999\",\"size\":\"20\"},on:{\"click\":_vm.onPopupOpen}})],1),_c('article-list',{attrs:{\"data\":_vm.results,\"req\":_vm.onReq,\"closeable\":true},on:{\"close\":_vm.onArticleClose}}),_c('van-popup',{staticClass:\"popup\",style:({ height: '100vh', width: '100%' }),attrs:{\"closeable\":\"\",\"position\":\"left\"},model:{value:(_vm.popupVisible),callback:function ($$v) {_vm.popupVisible=$$v},expression:\"popupVisible\"}},[_c('header',[_vm._v(\" 我的频道： \"),_c('span',{staticClass:\"tip\"},[_vm._v(\"点击进入频道\")]),_c('van-button',{attrs:{\"plain\":!_vm.isEdit,\"round\":\"\",\"type\":\"primary\",\"size\":\"mini\"},on:{\"click\":_vm.compile}},[_vm._v(\" \"+_vm._s(_vm.isEdit ? '完成' : '编辑')+\" \")])],1),_c('div',{staticClass:\"channels\"},_vm._l((_vm.channels),function(item,index){return _c('div',{key:item.id,staticClass:\"channel\",class:{ active: _vm.activeChannel === item.id },on:{\"click\":function($event){_vm.isEdit && _vm.closeChannel(item.id)}}},[_c('span',{on:{\"click\":function($event){(!_vm.isEdit) && _vm.onChannelClick(index)}}},[_vm._v(_vm._s(item.name))]),_c('van-icon',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isEdit),expression:\"isEdit\"}],staticClass:\"close\",attrs:{\"name\":\"cross\"}})],1)}),0),_c('header',[_vm._v(\"可选频道：\")]),_c('div',{staticClass:\"channels\"},_vm._l((_vm.restChannels),function(item){return _c('div',{key:item.id,staticClass:\"channel\",on:{\"click\":function($event){return _vm.addChannel(item)}}},[_vm._v(\" + \"+_vm._s(item.name)+\" \")])}),0)])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import req from '@/utils/request';\r\n\r\n// 获取频道列表\r\nexport function getChannelList() {\r\n  return req({\r\n    url: '/user/channels',\r\n  });\r\n}\r\n\r\n// 获取所有频道列表\r\nexport function getAllChannelList() {\r\n  return req({\r\n    url: '/channels',\r\n  });\r\n}\r\n\r\n// 删除频道\r\nexport function deleteChannel(id) {\r\n  return req({\r\n    url: `/user/channels/${id}`,\r\n    method: 'DELETE',\r\n  });\r\n}\r\n\r\n// 添加频道\r\nexport function addChannel(data) {\r\n  return req({\r\n    url: '/user/channels',\r\n    method: 'PATCH',\r\n    data\r\n  });\r\n}\r\n","<template>\r\n  <div class=\"homepage\">\r\n    <header>\r\n      <nav>\r\n        <van-tabs\r\n          v-model=\"activeChannel\"\r\n          @change=\"onTabChange\"\r\n        >\r\n          <van-tab\r\n            v-for=\"item in channels\"\r\n            :key=\"item.id\"\r\n            :title=\"item.name\"\r\n          />\r\n        </van-tabs>\r\n      </nav>\r\n      <van-icon\r\n        class=\"icon\"\r\n        name=\"search\"\r\n        color=\"#999\"\r\n        size=\"20\"\r\n        @click=\"onSearch\"\r\n      />\r\n      <van-icon\r\n        class=\"icon\"\r\n        name=\"more-o\"\r\n        color=\"#999\"\r\n        size=\"20\"\r\n        @click=\"onPopupOpen\"\r\n      />\r\n    </header>\r\n    <article-list\r\n      :data=\"results\"\r\n      :req=\"onReq\"\r\n      :closeable=\"true\"\r\n      @close=\"onArticleClose\"\r\n    />\r\n    <!-- 弹出层 -->\r\n    <van-popup\r\n      closeable\r\n      v-model=\"popupVisible\"\r\n      position=\"left\"\r\n      :style=\"{ height: '100vh', width: '100%' }\"\r\n      class=\"popup\"\r\n    >\r\n      <header>\r\n        我的频道：\r\n        <span class=\"tip\">点击进入频道</span>\r\n        <van-button\r\n          :plain=\"!isEdit\"\r\n          round\r\n          type=\"primary\"\r\n          size=\"mini\"\r\n          @click=\"compile\"\r\n        >\r\n          {{ isEdit ? '完成' : '编辑' }}\r\n        </van-button>\r\n      </header>\r\n\r\n      <!-- 我的频道 -->\r\n      <div class=\"channels\">\r\n        <div\r\n          class=\"channel\"\r\n          :class=\"{ active: activeChannel === item.id }\"\r\n          v-for=\"(item,index) in channels\"\r\n          :key=\"item.id\"\r\n          @click=\"isEdit && closeChannel(item.id)\"\r\n        >\r\n          <span @click=\"(!isEdit) && onChannelClick(index)\">{{ item.name }}</span>\r\n          <van-icon\r\n            class=\"close\"\r\n            name=\"cross\"\r\n            v-show=\"isEdit\"\r\n          />\r\n        </div>\r\n      </div>\r\n      <!-- 可选频道 -->\r\n      <header>可选频道：</header>\r\n      <div class=\"channels\">\r\n        <div\r\n          class=\"channel\"\r\n          v-for=\"item in restChannels\"\r\n          :key=\"item.id\"\r\n          @click=\"addChannel(item)\"\r\n        >\r\n          + {{ item.name }}\r\n        </div>\r\n      </div>\r\n    </van-popup>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as channelApi from '@/api/channel';\r\nimport * as articleApi from '@/api/search';\r\nimport ArticleList from '@/components/article-list';\r\n\r\nlet preTimestamp;\r\n\r\nexport default {\r\n  components: {\r\n    ArticleList,\r\n  },\r\n\r\n  data() {\r\n    return {\r\n      channels: [],\r\n      allChannels: [],\r\n      popupVisible: false,\r\n      isEdit: false,\r\n      activeChannel: 0,\r\n      results: [],\r\n      options: [],\r\n    };\r\n  },\r\n  computed: {\r\n    // 剩余频道\r\n    restChannels() {\r\n      return this.allChannels.filter(\r\n        (item) => !this.channels.some((channel) => channel.id === item.id)\r\n      );\r\n    },\r\n  },\r\n  created() {\r\n    this.refreshChannelList();\r\n    // this.onTabChange(this.activeChannel);\r\n    // channelApi.getAllChannelList().then((res) => {\r\n    //   this.allChannels = res.data.data.channels;\r\n    // });\r\n  },\r\n  methods: {\r\n    onPopupOpen() {\r\n      this.popupVisible = true;\r\n    },\r\n    onSearch() {\r\n      this.$router.push('/search');\r\n    },\r\n    // 切换编辑状态\r\n    compile() {\r\n      this.isEdit = !this.isEdit;\r\n    },\r\n    // 刷新频道列表\r\n    refreshChannelList() {\r\n      channelApi.getChannelList().then((res) => {\r\n        this.channels = res.data.data.channels;\r\n      });\r\n    },\r\n    onArticleClose() {\r\n      console.log(123);\r\n    },\r\n    async onTabChange(id) {\r\n      const res = await articleApi.getChannelArticleList(id, Date.now());\r\n      // getSearchSuggest的用法是：如果有值就用，没有值就用默认值\r\n      preTimestamp = res.data.data.pre_timestamp;\r\n      this.results = res.data.data.results;\r\n    },\r\n    async onReq() {\r\n      const res = await articleApi.getChannelArticleList(this.activeChannel, !preTimestamp ? Date.now() : preTimestamp);\r\n      preTimestamp = res?.data?.data?.pre_timestamp;\r\n      this.results = this.results.concat(res.data.data.results);\r\n      return true;\r\n    },\r\n    // 删除频道\r\n    async closeChannel(id) {\r\n      // 删除\r\n      await channelApi.deleteChannel(id);\r\n      // 刷新\r\n      this.refreshChannelList();\r\n    },\r\n    // 添加频道\r\n    async addChannel(channel) {\r\n      const data = {\r\n        channels: [{\r\n          id: item.id,\r\n          name: item.name,\r\n        }]\r\n      };\r\n      // 新增\r\n      await channelApi.addChannel(channel);\r\n      // 刷新\r\n      this.refreshChannelList();\r\n    },\r\n    onChannelClick(index) {\r\n      this.popupVisible = false;\r\n      this.activeChannel = index;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.homepage {\r\n  header {\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    nav {\r\n      flex: 1;\r\n      overflow: hidden;\r\n      position: relative;\r\n\r\n      /deep/ .van-tab--active span {\r\n        font-size: 18px;\r\n      }\r\n\r\n      &::after {\r\n        content: '';\r\n        display: block;\r\n        position: absolute;\r\n        top: 0;\r\n        right: 0;\r\n        height: 100%;\r\n        width: 40px;\r\n        background: linear-gradient(to right, rgba(255, 255, 255, 0), #fff);\r\n        // 点击穿透\r\n        pointer-events: none;\r\n      }\r\n    }\r\n\r\n    .icon {\r\n      margin: 0 8px;\r\n    }\r\n  }\r\n\r\n  // 弹出层\r\n  .popup {\r\n    padding: 16px;\r\n    box-sizing: border-box;\r\n\r\n    header {\r\n      margin-top: 32px;\r\n      display: flex;\r\n\r\n      .tip {\r\n        flex: 1;\r\n        font-size: 12px;\r\n        color: @text-gray;\r\n      }\r\n\r\n      /deep/ .van-button--mini {\r\n        padding: 0 16px;\r\n      }\r\n    }\r\n\r\n    .channels {\r\n      margin-top: 8px;\r\n\r\n      .channel {\r\n        padding: 0px 16px;\r\n        height: 32px;\r\n        line-height: 32px;\r\n        background: #f7f8fa;\r\n        border-radius: 99px;\r\n        display: inline-block;\r\n        margin: 0 8px 8px 0;\r\n        position: relative;\r\n        .close {\r\n          position: absolute;\r\n          top: -2px;\r\n          right: -2px;\r\n          font-size: 12px;\r\n          border: 1px solid black;\r\n          border-radius: 50%;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../node_modules/.pnpm/thread-loader@3.0.4_webpack@5.75.0/node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/.pnpm/babel-loader@8.3.0_la66t7xldg4uecmyawueag5wkm/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../../node_modules/.pnpm/vue-loader@15.10.1_y5o36p7qrshhm4v7l6yk7rwfsu/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/.pnpm/thread-loader@3.0.4_webpack@5.75.0/node_modules/thread-loader/dist/cjs.js!../../../../../node_modules/.pnpm/babel-loader@8.3.0_la66t7xldg4uecmyawueag5wkm/node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../../node_modules/.pnpm/vue-loader@15.10.1_y5o36p7qrshhm4v7l6yk7rwfsu/node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=19782254&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=19782254&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/.pnpm/vue-loader@15.10.1_y5o36p7qrshhm4v7l6yk7rwfsu/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"19782254\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","on","onTabChange","model","value","activeChannel","callback","$$v","expression","_l","channels","item","key","id","attrs","name","onSearch","onPopupOpen","results","onReq","onArticleClose","style","height","width","popupVisible","_v","isEdit","compile","_s","index","class","active","$event","closeChannel","onChannelClick","directives","rawName","restChannels","addChannel","staticRenderFns","getChannelList","req","url","deleteChannel","method","data","preTimestamp","components","ArticleList","allChannels","options","computed","created","methods","refreshChannelList","channelApi","console","component"],"sourceRoot":""}